# LLM Model Configuration
# Central configuration for all model usage across the project

default:
  model: "gpt4o_mini"  # Primary working model - maximum cost optimization
  max_tokens: 1000
  temperature: 0.0  # Deterministic for consistent classification

# Alternative models for specific use cases or experiments
models:
  # Anthropic Claude Models
  opus:
    model: "anthropic/claude-3-opus-20240229"
    max_tokens: 1000
    temperature: 0.0
    description: "Premium model - highest quality, use for difficult cases"

  haiku:
    model: "anthropic/claude-3-haiku-20240307"
    max_tokens: 1000
    temperature: 0.0
    description: "Ultra-fast model - maximum cost optimization, good quality"

  sonnet:
    model: "anthropic/claude-3-5-sonnet-20241022"
    max_tokens: 1000
    temperature: 0.0
    description: "Balanced model - cost-optimized, fast, high quality"

  sonnet_legacy:
    model: "anthropic/claude-3-sonnet-20241022"
    max_tokens: 1000
    temperature: 0.0
    description: "Legacy sonnet model - may not be available"

  # OpenAI GPT Models (three-tier structure)
  gpt4o_mini:
    model: "openai/gpt-4o-mini"
    max_tokens: 1000
    temperature: 0.0
    description: "Fast OpenAI model - cost-optimized, comparable to Haiku"

  gpt4o:
    model: "openai/gpt-4o"
    max_tokens: 1000
    temperature: 0.0
    description: "Premium OpenAI model - highest quality, comparable to Opus"

  gpt4o_mini:
    model: "openai/gpt-4o-mini"
    max_tokens: 1000
    temperature: 0.0
    description: "Fast OpenAI model - cost-optimized, comparable to Haiku"

  gpt4_turbo:
    model: "openai/gpt-4-turbo-preview"
    max_tokens: 1000
    temperature: 0.0
    description: "Balanced OpenAI model - good quality and speed, comparable to Sonnet"

# Experiment-specific configurations
experiments:
  temperature_test:
    model: "anthropic/claude-3-opus-20240229"
    max_tokens: 1000
    temperature: 0.7
    description: "Testing temperature effects on classification"

  batch_processing:
    model: "anthropic/claude-3-opus-20240229"
    max_tokens: 2000  # Larger context for batch classification
    temperature: 0.0
    description: "Configuration for batch processing multiple products"

# API configuration
api:
  retry_attempts: 3
  initial_retry_delay: 30  # seconds
  exponential_backoff: true
  rate_limit_delay: 60  # seconds between products

# Use case specific configurations
use_cases:
  product_classification:
    default_model: "gpt4o_mini"
    max_tokens: 1000
    temperature: 0.0
    batch_size: 10
    retry_on_parse_error: true

  health_quiz:
    default_model: "gpt4o_mini"  # Same as product classification for cost
    max_tokens: 1000
    temperature: 0.0  # Deterministic for medical consistency
    max_recommendations: 5
    min_relevance_score: 0.3
    include_educational_content: true
    consultation_threshold: 7  # Severity level triggering consultation recommendation
    response_format: "json"  # Structured output format
    # WordPress/WooCommerce URL Configuration
    # TESTED: ID-based URLs don't work (?product=ID, /product/ID/ all return 404)
    # WORKING: Slug-based URLs work (e.g., /product/hemp-adapt-2oz/)
    # IMPLEMENTATION: Algorithmic slug generation from product titles
    product_url_template: "https://rogueherbalist.com/product/{product_slug}/"
    # Fallback if slug generation fails:
    # product_url_template: "https://rogueherbalist.com/shop/"

  taxonomy_generation:
    default_model: "gpt4o"  # Premium quality with tightened brevity prompt (references gpt4o alias)
    max_tokens: 16000  # GPT-4o hard limit: 16,384 tokens output maximum
    temperature: 0.1  # Slight creativity for improvements while maintaining consistency
    validation_retries: 3  # Number of retry attempts if validation fails
    include_diff_report: true  # Generate diff reports comparing before/after
    document_format: "xml"  # Expected document format
    preserve_structure: true  # Maintain original XML structure and hierarchy
    chunk_size: 3  # Maximum taxons per chunk (including subcategories) - stays under 16K output limit
    # GPT-4o: $2.50/1M input + $10.00/1M output tokens (~$0.56 for full taxonomy)
    # With tightened brevity prompt: produces excellent concise content

  seo_generation:
    default_model: "gpt4o"  # Premium quality for SEO metadata
    max_tokens: 2000  # Small - only generating <seo> block (~15 lines)
    temperature: 0.1  # Consistent SEO generation
    validation_retries: 3  # Number of retry attempts if validation fails
    validate_urls: true  # Check canonical URLs actually work (HTTP HEAD request)

    # SEO field specifications
    fields:
      focus-keyword:
        required: true
        max_chars: 40
        description: "2-4 word keyword phrase, more specific for subcategories"

      meta-title:
        required: true
        max_chars: 60
        suffix: " | Rogue Herbalist"
        description: "Page title for search results, includes brand"

      meta-description:
        required: true
        max_chars: 160
        description: "Search result description, benefit-driven, mentions 2-3 ingredients"

      h1:
        required: true
        max_chars: 70
        description: "Main page heading, include focus keyword"

      og-title:
        required: true
        max_chars: 90
        description: "Social sharing title, more engaging than meta-title"

      og-description:
        required: true
        max_chars: 300
        description: "Social sharing description, conversational"

      keywords:
        required: true
        max_chars: 120
        description: "5-10 comma-separated keywords"

      canonical-url:
        required: true
        description: "Full canonical URL for the page"

      schema-type:
        required: true
        default: "CollectionPage"
        description: "Schema.org type"

    # URL templates for different element types
    url_templates:
      primary: "https://rogueherbalist.com/category/{slug}/"
      subcategory: "https://rogueherbalist.com/category/{parent_slug}/{slug}/"
      product: "https://rogueherbalist.com/product/{slug}/"
      default: "https://rogueherbalist.com/{slug}/"

    # Element-specific XPath for finding elements to enhance
    element_xpath: ".//taxon"  # For taxonomies; change to ".//product" for product catalogs

    # GPT-4o: $2.50/1M input + $10.00/1M output tokens
    # ~87 calls for full taxonomy: 87 Ã— (800 input + 200 output) = ~$0.26

# Client-aware cost tracking configuration
client_tracking:
  client: "get-better-care"
  use_case: "herbal-classification"
  project: "ic-ml"
  environment: "production"
  tags:
    - "herbal-products"
    - "classification"
    - "taxonomy-based"

# Legacy metadata (kept for compatibility)
metadata:
  client: "rogue_herbalist"
  business: "get_better_care"